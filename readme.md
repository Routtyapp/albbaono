# GEO Tracker

AI 가시성(GEO - Generative Engine Optimization) 분석 및 리포팅 플랫폼

---

## PDF 생성 시스템 아키텍처

### 1. 전체 파이프라인 개요

본 프로젝트의 PDF 생성 시스템은 **3계층 하이브리드 아키텍처**를 채택하고 있습니다.

```
[클라이언트 (React)]
        ↓ HTTP POST (JSON 데이터)
[서버 (Node.js/Express)]
        ↓ 프로세스 스폰 (stdin/stdout)
[Python 스크립트 (ReportLab + Matplotlib)]
        ↓ 파일 시스템
[PDF 파일 생성]
        ↓ 바이너리 스트림
[클라이언트 다운로드]
```

이 구조는 각 언어의 강점을 활용합니다:
- **JavaScript/TypeScript**: 웹 인터페이스 및 API 라우팅
- **Python**: 과학 계산, 시각화, PDF 렌더링에 최적화된 라이브러리 생태계

---

### 2. 데이터 흐름 상세

#### Phase 1: 요청 초기화
클라이언트에서 리포트 데이터를 JSON 형태로 서버에 전송합니다. 데이터에는 핵심 지표(인용률, 테스트 수, 엔진별 성과 등)와 메타정보(기간, 타입)가 포함됩니다.

#### Phase 2: 임시 작업공간 생성
서버는 유니크한 타임스탬프 기반 임시 디렉토리를 생성합니다. 이 공간은 중간 산출물(차트 이미지, JSON 파일)을 격리하여 동시 요청 간 충돌을 방지합니다.

#### Phase 3: 차트 렌더링 (선행 단계)
Matplotlib 기반 Python 스크립트가 데이터를 시각화합니다:
- **라인 차트**: 시계열 인용률 트렌드
- **막대 차트**: AI 엔진별 성과 비교, 상위 쿼리
- **도넛 차트**: 카테고리 분포, 달성률 게이지

차트는 PNG 래스터 이미지로 저장되며, PDF 문서에 임베딩됩니다.

#### Phase 4: PDF 문서 조립
ReportLab의 Platypus 엔진이 문서를 구성합니다:
1. **Flowable 요소 스택 구성**: Paragraph, Table, Image, Spacer 등의 요소를 순차적으로 스택에 추가
2. **레이아웃 엔진 실행**: A4 페이지 사이즈 기준으로 자동 페이지 분할
3. **PDF 바이너리 생성**: 벡터 그래픽과 래스터 이미지를 단일 PDF로 병합

#### Phase 5: 응답 및 정리
생성된 PDF를 바이너리 스트림으로 클라이언트에 전송한 후, 임시 디렉토리를 비동기로 삭제합니다.

---

### 3. PDF 렌더링 알고리즘

#### 3.1 문서의 설계 목표

본 문서는 데이터 시각화와 감사 인증 문서의 신뢰감을 결합한다.

| 목표 | 구현 방식 |
|------|----------|
| 데이터 가시성 | 차트, KPI 카드, 색상 코딩으로 핵심 지표 즉시 인지 |
| 체계적 감사 인상 | 표준화된 표 구조, 섹션 넘버링, 반복 포맷 |
| 객관적 판단 제시 | 감정 배제, 사실 나열, PASS/FAIL 명시 |
| 기관 발행 인상 | 격식 있는 레이아웃, 인증 페이지 구성 |

---

#### 3.2 디자인 시스템

**컬러 체계**

| 용도 | 컬러 | 적용 |
|------|------|------|
| 기본 배경 | 흑백 + 회색 | 문서 전반의 격식 |
| 성과 지표 | 녹색/빨간색 | 증감, PASS/FAIL 판단 |
| 등급 표시 | 그라데이션 팔레트 | A+ ~ F 시각적 구분 |
| 엔진 구분 | 브랜드 컬러 | GPT(녹색), Gemini(파란색), Claude(주황색) |

**타이포그래피**

- 산세리프 폰트 사용 (Helvetica / 맑은고딕)
- Bold / Regular 대비 명확히 구분
- 섹션 제목은 넘버링 적용 (01, 02, 03...)
- 자간 넓게 설정하여 가독성 확보

---

#### 3.3 레이아웃 문법

**표 기반 구조**

본 문서는 표와 박스가 주인공이다. 시각적 지표도 표 구조 안에서 제시한다.

| 요소 | 목적 |
|------|------|
| 표 (Table) | 논리와 체계 인상. 데이터 비교에 사용 |
| 지표 카드 | KPI의 즉각적 인지. 표 셀 내 배치 |
| 차트 | 트렌드와 분포의 시각화. 표와 함께 배치 |
| 박스 | 통제된 정보 영역. 요약/결론에 사용 |
| 선 | 섹션 구분과 정보 분해 |

**좌우 분리 레이아웃**

복합 정보 제시 시 좌우 분리를 활용한다.

| 좌측 | 우측 |
|------|------|
| 분석 대상 (팩트) | 분석 관점 (해석/기준) |
| 차트/지표 | 설명/판단 |

---

#### 3.4 섹션 흐름 설계

문서는 다음 순서를 따른다. 데이터 제시에서 인증으로 승격되는 구조이다.

| 순서 | 섹션 | 역할 | 주요 요소 |
|------|------|------|----------|
| 01 | SUMMARY | 핵심 지표 요약 | KPI 카드, 증감 표시 |
| 02 | TREND | 추이 분석 | 라인 차트 |
| 03 | PROFILE | 상세 분석 | 엔진별/쿼리별 표, 막대 차트 |
| 04 | ISSUE | 개선 필요 항목 | 문제점 테이블 |
| 05 | RECOMMENDATION | 권장 사항 | 판단 및 제안 |
| 06 | CERTIFICATION | 문서 인증 | 생성 정보, 푸터 |

---

#### 3.5 문체 스타일

| 요소 | 원칙 |
|------|------|
| 감정 | 배제 |
| 형용사 | 최소화 |
| 서술 | 사실 나열 |
| 판단 | 명시적 (PASS/FAIL, 양호/개선필요) |

---

#### 3.6 기술 구현

**스타일 시트 패턴**: ParagraphStyle 객체를 통해 재사용 가능한 타이포그래피 정의를 관리한다. 폰트, 크기, 행간, 정렬, 색상을 캡슐화하여 일관성을 보장한다.

**테이블 기반 레이아웃**: Table 객체와 TableStyle을 통해 지표 카드와 데이터 그리드를 구현한다. 셀 병합, 배경색, 테두리, 패딩을 선언적으로 정의한다.

**한글 폰트 처리**:
1. Windows 폰트 디렉토리에서 맑은 고딕 또는 나눔고딕 검색
2. TTFont 객체로 등록 후 전역 폰트 변수에 할당
3. 폰트 미발견 시 Helvetica 폴백

**페이지 분할 로직**:
- 요소가 현재 페이지 잔여 공간을 초과하면 자동으로 다음 페이지로 이동
- KeepTogether 래퍼로 묶인 요소는 분리되지 않음
- 주요 섹션은 PageBreak로 새 페이지에서 시작

---

### 4. 차트 생성 알고리즘

#### 4.1 시각화 설계 원칙

**색상 시스템**: AI 엔진별 고유 색상(GPT: 녹색, Gemini: 파란색, Claude: 주황색 등)을 정의하여 브랜드 인식성을 높입니다.

**반응형 레이블링**: 데이터 포인트 위에 값을 표시하고, 긴 텍스트는 말줄임 처리합니다.

**그라데이션 및 투명도**: 라인 차트 아래 영역을 반투명으로 채워 시각적 무게감을 부여합니다.

#### 4.2 차트 유형별 특성

| 차트 유형 | 용도 | 주요 파라미터 |
|-----------|------|---------------|
| 라인 차트 | 시계열 트렌드 | 마커 크기, 선 두께, 영역 투명도 |
| 수평 막대 | 엔진별 비교 | 막대 높이, 레이블 위치, 색상 매핑 |
| 수직 막대 | 쿼리별 성과 | 그라데이션 색상, 회전 레이블 |
| 도넛 차트 | 비율 표현 | 중앙 홀 크기, 폭발 효과, 시작 각도 |

---

### 5. 리포트 유형

#### 5.1 AI 가시성 리포트 (주간/월간)
- **요약 섹션**: 핵심 KPI 카드 (인용률, 테스트 수, SOV, 평균 순위)
- **트렌드 섹션**: 기간별 인용률 변화 차트
- **엔진 분석**: AI 엔진별 성과 비교 테이블 및 차트
- **쿼리 분석**: 상위/하위 쿼리 테이블
- **권장 사항**: 데이터 기반 자동 생성 개선 제안

#### 5.2 GEO Score 분석 리포트
- **종합 점수**: 100점 만점 점수 및 등급 (A+ ~ F)
- **카테고리 분석**: 구조, 스키마, URL, 메타태그, 콘텐츠 5개 영역
- **상세 항목**: 각 카테고리 내 개별 체크 항목 통과/미통과 상태
- **개선 권장사항**: 우선순위별 문제점 및 해결 제안
- **페이지별 점수**: 다중 페이지 분석 시 개별 페이지 점수

---

### 6. 기술 스택

| 계층 | 기술 | 역할 |
|------|------|------|
| 프론트엔드 | React + TypeScript | 사용자 인터페이스 |
| 서버 | Node.js + Express | API 라우팅, 프로세스 관리 |
| PDF 엔진 | Python ReportLab | 벡터 PDF 생성 |
| 차트 엔진 | Python Matplotlib | 래스터 시각화 |
| 프로세스 통신 | child_process.spawn | Node-Python IPC |

---

## 개발 환경 설정

### 프론트엔드
```bash
npm install
npm run dev
```

### 서버 (PDF 생성 포함)
```bash
cd server
npm install
pip install reportlab matplotlib numpy
npm run dev
```

---

## 라이선스

MIT License
